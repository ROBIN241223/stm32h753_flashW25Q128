/*
 * FreeRTOS+CLI V1.0.4
 * Copyright (C) 2017 Amazon.com, Inc. or its affiliates.  All Rights Reserved.
 */

#ifndef FREERTOS_CLI_H
#define FREERTOS_CLI_H

#ifdef __cplusplus
extern "C" {
#endif

/* FreeRTOS includes. */
#ifndef INC_FREERTOS_H
    #include "FreeRTOS.h"
#endif

typedef BaseType_t (*pdCOMMAND_LINE_CALLBACK)( char *pcWriteBuffer, size_t xWriteBufferLen, const char *pcCommandString );

typedef struct xCOMMAND_LINE_INPUT
{
    const char * const pcCommand;               /* The command that causes pxCommandInterpreter to be executed. */
    const char * const pcHelpString;            /* String that describes how to use the command. */
    const pdCOMMAND_LINE_CALLBACK pxCommandInterpreter; /* A pointer to the callback function that will return the output generated by the command. */
    int8_t cExpectedNumberOfParameters;         /* Commands expect a fixed number of parameters, although this is -1 if the command can take a variable number of parameters. */
} CLI_Command_Definition_t;

/*
 * Register a command with the command interpreter.  The pcCommand parameter is
 * the name of the command, and pxCommandInterpreter is the callback function
 * that implements the command.
 */
BaseType_t FreeRTOS_CLIRegisterCommand( const CLI_Command_Definition_t * const pxCommandToRegister );

/*
 * Process the command string passed in the pcCommandInput parameter.  This
 * function will call the callback function associated with the command, if it
 * can find a matching command in the list of registered commands.  The callback
 * function will generate output, and write it to the buffer pointed to by
 * pcWriteBuffer.  The size of the buffer is passed in xWriteBufferLen.
 */
BaseType_t FreeRTOS_CLIProcessCommand( const char * const pcCommandInput, char * pcWriteBuffer, size_t xWriteBufferLen );

/*
 * Obtain a pointer to the output buffer.  The output buffer is defined within
 * FreeRTOS_CLI.c, but this function allows it to be used from external files.
 */
char *FreeRTOS_CLIGetOutputBuffer( void );

/*
 * Obtain the parameter string from the command string.
 */
const char *FreeRTOS_CLIGetParameter( const char *pcCommandString, UBaseType_t uxWantedParameter, BaseType_t *pxParameterStringLength );

#ifdef __cplusplus
}
#endif

#endif /* FREERTOS_CLI_H */
